<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        html, body {
            width: 100%;
            min-height: 100%;
            background: transparent;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            overflow: visible;
        }

        iframe {
            width: 100%;
            min-height: 100vh;
            border: none;
            display: block;
            background: transparent;
        }
    </style>
</head>
<body>
    <!--
      IMPORTANT: Replace "YOUR-HOSTED-URL" with the actual URL where you
      uploaded your index.html file. Examples:

      - GitHub Pages: https://yourusername.github.io/catalystmagazineposts/
      - Netlify: https://yoursite.netlify.app/
      - Custom Domain: https://yourdomain.com/magazine/
      - Wix File Manager: https://yoursite.wixsite.com/files/index.html
    -->
    <iframe
        src="https://sillybob123.github.io/catalystmagazineposts/index.html"
        id="magazine-embed"
        title="Catalyst Magazine"
        loading="eager"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
        sandbox="allow-scripts allow-same-origin allow-popups allow-popups-to-escape-sandbox allow-forms allow-top-navigation"
    ></iframe>

    <script>
        (function() {
            const iframe = document.getElementById('magazine-embed');
            let lastHeight = 1200; // safe fallback for zoomed-in users

            const applyHeight = (rawHeight) => {
                if (!iframe) return;
                const parsed = Math.ceil(Number(rawHeight) || 0);
                const next = Math.max(parsed + 24, 1200);
                if (next === lastHeight) return;
                lastHeight = next;
                iframe.style.height = `${next}px`;
                iframe.style.minHeight = `${next}px`;

                // Bubble the height up to the host page (Wix listens for postMessages)
                try {
                    if (window.parent && window.parent !== window) {
                        window.parent.postMessage({ type: 'setHeight', height: next }, '*');
                        window.parent.postMessage({ type: 'embed-size', height: next }, '*');
                    }
                } catch (err) {
                    console.warn('Unable to propagate height to parent', err);
                }
            };

            // Auto-resize iframe to match content height
            window.addEventListener('message', function(event) {
                const data = event.data || {};
                if (!data || typeof data !== 'object') return;
                if (data.type === 'setHeight' || data.type === 'embed-size') {
                    applyHeight(data.height);
                }
            }, false);

            // Ensure iframe loads properly and has a generous minimum height
            document.addEventListener('DOMContentLoaded', function() {
                if (iframe) {
                    iframe.style.minHeight = `${lastHeight}px`;
                    iframe.addEventListener('load', function() {
                        applyHeight(lastHeight);
                        console.log('Catalyst Magazine loaded successfully');
                    });
                }
            });

            window.addEventListener('resize', () => applyHeight(lastHeight));
        })();
    </script>
</body>
</html>
