<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>Catalyst Magazine</title>
    <meta name="description" content="Science, Policy, and Innovation from the Nation's Capital.">

    <!-- Critical Performance Optimizations -->
    <link rel="preconnect" href="https://static.wixstatic.com" crossorigin>
    <link rel="dns-prefetch" href="https://static.wixstatic.com">
    <link rel="preconnect" href="https://static.wixstatic.com/media" crossorigin>

    <!-- Preload first hero image for instant display -->
    <link rel="preload" as="image" href="https://static.wixstatic.com/media/11b1c4_790a12e131b64175aa547cdd45d902c1~mv2.jpg/v1/fill/w_720,h_405,al_c,q_85,usm_0.66_1.00_0.01/optimized.webp" fetchpriority="high">

    <!-- Preload Critical Assets -->
    <link rel="stylesheet" href="css/style.css">

    <!-- Apple PWA Settings -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <!-- CRITICAL: Early Safari scroll passthrough setup -->
    <script>
        // Run IMMEDIATELY before any other scripts to prevent Safari scroll capture
        (function() {
            if (window.parent === window) return; // Not in iframe

            // Immediately apply CSS fixes for Safari
            const style = document.createElement('style');
            style.textContent = `
                html, body {
                    touch-action: none !important;
                    overflow: hidden !important;
                    -webkit-overflow-scrolling: auto !important;
                    overscroll-behavior: none !important;
                }
                html *, body * {
                    touch-action: none !important;
                }
            `;
            (document.head || document.documentElement).appendChild(style);

            // Flag as embed immediately
            document.documentElement.classList.add('is-embed');
        })();
    </script>
</head>
<body>

    <!-- STICKY HEADER (Search & Nav) -->
    <header class="sticky-header">
        <div class="header-content">
            <!-- Search Bar -->
            <div class="search-wrapper">
                <svg class="search-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Search">
                    <circle cx="11" cy="11" r="8"></circle>
                    <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                </svg>
                <input type="text" class="search-input" id="searchInput" placeholder="Search articles, authors, or topics..." autocomplete="off">
            </div>
            
            <!-- Category Navigation -->
            <nav class="category-nav" id="categoryNav">
                <button class="nav-pill active" type="button" data-target="recent">Recent</button>
                <button class="nav-pill" type="button" data-target="neuro">Neuroscience</button>
                <button class="nav-pill" type="button" data-target="biochemphys">Bio/Chem/Phys</button>
                <button class="nav-pill" type="button" data-target="env">Environment</button>
                <button class="nav-pill" type="button" data-target="public">Public Health</button>
                <button class="nav-pill" type="button" data-target="biotech">Biotech & AI</button>
            </nav>
        </div>
    </header>

    <!-- MAIN FEED -->
    <main class="feed-container">

        <!-- HERO: RECENT STORIES -->
        <section class="hero-section" id="recent">
            <div class="section-header hero-header">
                <div class="section-lede">
                    <h1 class="hero-title">Recent Stories</h1>
                </div>
            </div>
            <div class="hero-shell">
                <div class="hero-track" id="recent-track">
                    <!-- Injected via JS -->
                </div>
            </div>
        </section>

        <!-- CATEGORY ROWS -->
        <section class="category-row" id="neuro" data-cat="neuro">
            <h2 class="category-title">Neuroscience & Medicine</h2>
            <div class="std-track" id="container-neuro"></div>
        </section>

        <section class="category-row" id="biochemphys" data-cat="biochemphys">
            <h2 class="category-title">Biology, Chemistry & Physics</h2>
            <div class="std-track" id="container-biochemphys"></div>
        </section>

        <section class="category-row" id="env" data-cat="env">
            <h2 class="category-title">Environmental Science</h2>
            <div class="std-track" id="container-env"></div>
        </section>

        <section class="category-row" id="public" data-cat="public">
            <h2 class="category-title">Public Health & SciComm</h2>
            <div class="std-track" id="container-public"></div>
        </section>

        <section class="category-row" id="biotech" data-cat="biotech">
            <h2 class="category-title">Biotech & AI</h2>
            <div class="std-track" id="container-biotech"></div>
        </section>

        <section class="editorial-section" id="editorials">
            <div class="editorial-shell">
                <div class="editorial-header">
                    <div class="editorial-title-block">
                        <p class="editorial-eyebrow">Hear From Our Editors</p>
                        <h2 class="editorial-heading">Capital Perspectives</h2>
                        <p class="editorial-subtitle">Op-eds from the Catalyst desk on science, policy, and the stories shaping the District.</p>
                    </div>
                    <div class="editorial-badge">
                        <span class="badge-dot"></span>
                        Editors' Desk
                    </div>
                </div>
                <div class="editorial-grid" id="editorials-container"></div>
            </div>
        </section>

        <div id="noResults" class="no-results hidden">No articles match your search just yet.</div>

    </main>

    <!-- Load Scripts -->
    <script src="js/data.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
